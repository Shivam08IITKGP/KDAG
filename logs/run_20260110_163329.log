2026-01-10 16:33:29 | INFO     | root | setup_logging:73 | Logging initialized. Log file: logs/run_20260110_163329.log
2026-01-10 16:33:29 | INFO     | __main__ | main:170 | Starting Evidence-Grounded Backstory Consistency System
2026-01-10 16:33:29 | INFO     | __main__ | read_train_data:87 | Reading first 2 rows from train.csv
2026-01-10 16:33:29 | INFO     | __main__ | read_train_data:90 | Loaded 2 rows from train.csv
2026-01-10 16:33:29 | INFO     | __main__ | main:176 | Processing 2 backstories
2026-01-10 16:33:29 | DEBUG    | asyncio | __init__:64 | Using selector: KqueueSelector
2026-01-10 16:33:29 | INFO     | pathway_engine.engine.dataflow | None:5322 | Preparing Pathway computation
2026-01-10 16:33:29 | DEBUG    | pathway_engine.engine.telemetry | None:399 | Telemetry disabled
2026-01-10 16:33:29 | INFO     | pathway_engine.connectors.monitoring | None:43 | FilesystemReader-0: 0 entries (1 minibatch(es)) have been sent to the engine
2026-01-10 16:33:29 | INFO     | pathway_engine.connectors.monitoring | None:43 | FilesystemReader-0: 18728 entries (2 minibatch(es)) have been sent to the engine
2026-01-10 16:33:29 | WARNING  | pathway_engine.connectors.monitoring | None:82 | FilesystemReader-0: Closing the data source
2026-01-10 16:33:37 | INFO     | sentence_transformers.SentenceTransformer | __init__:227 | Load pretrained SentenceTransformer: avsolatorio/GIST-small-Embedding-v0
2026-01-10 16:33:37 | DEBUG    | urllib3.connectionpool | _new_conn:1049 | Starting new HTTPS connection (1): huggingface.co:443
2026-01-10 16:33:37 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/modules.json HTTP/1.1" 307 0
2026-01-10 16:33:37 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/modules.json HTTP/1.1" 200 0
2026-01-10 16:33:37 | DEBUG    | filelock | acquire:331 | Attempting to acquire lock 5051187424 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/952a9b81c0bfd99800fabf352f69c7ccd46c5e43.lock
2026-01-10 16:33:37 | DEBUG    | filelock | acquire:334 | Lock 5051187424 acquired on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/952a9b81c0bfd99800fabf352f69c7ccd46c5e43.lock
2026-01-10 16:33:37 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/modules.json HTTP/1.1" 200 349
2026-01-10 16:33:37 | DEBUG    | filelock | release:364 | Attempting to release lock 5051187424 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/952a9b81c0bfd99800fabf352f69c7ccd46c5e43.lock
2026-01-10 16:33:37 | DEBUG    | filelock | release:367 | Lock 5051187424 released on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/952a9b81c0bfd99800fabf352f69c7ccd46c5e43.lock
2026-01-10 16:33:38 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/config_sentence_transformers.json HTTP/1.1" 307 0
2026-01-10 16:33:38 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/config_sentence_transformers.json HTTP/1.1" 200 0
2026-01-10 16:33:38 | DEBUG    | filelock | acquire:331 | Attempting to acquire lock 5069823904 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/dcb0c0d97d09b930d13600b1a773ddb27e441aab.lock
2026-01-10 16:33:38 | DEBUG    | filelock | acquire:334 | Lock 5069823904 acquired on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/dcb0c0d97d09b930d13600b1a773ddb27e441aab.lock
2026-01-10 16:33:38 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/config_sentence_transformers.json HTTP/1.1" 200 124
2026-01-10 16:33:38 | DEBUG    | filelock | release:364 | Attempting to release lock 5069823904 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/dcb0c0d97d09b930d13600b1a773ddb27e441aab.lock
2026-01-10 16:33:38 | DEBUG    | filelock | release:367 | Lock 5069823904 released on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/dcb0c0d97d09b930d13600b1a773ddb27e441aab.lock
2026-01-10 16:33:38 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/config_sentence_transformers.json HTTP/1.1" 307 0
2026-01-10 16:33:38 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/config_sentence_transformers.json HTTP/1.1" 200 0
2026-01-10 16:33:39 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/README.md HTTP/1.1" 307 0
2026-01-10 16:33:39 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/README.md HTTP/1.1" 200 0
2026-01-10 16:33:39 | DEBUG    | filelock | acquire:331 | Attempting to acquire lock 5068839088 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/c3db3cf743f4d9ca79acdade3cad3a5cdda0efbf.lock
2026-01-10 16:33:39 | DEBUG    | filelock | acquire:334 | Lock 5068839088 acquired on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/c3db3cf743f4d9ca79acdade3cad3a5cdda0efbf.lock
2026-01-10 16:33:39 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/README.md HTTP/1.1" 200 None
2026-01-10 16:33:39 | DEBUG    | filelock | release:364 | Attempting to release lock 5068839088 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/c3db3cf743f4d9ca79acdade3cad3a5cdda0efbf.lock
2026-01-10 16:33:39 | DEBUG    | filelock | release:367 | Lock 5068839088 released on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/c3db3cf743f4d9ca79acdade3cad3a5cdda0efbf.lock
2026-01-10 16:33:39 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/modules.json HTTP/1.1" 307 0
2026-01-10 16:33:39 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/modules.json HTTP/1.1" 200 0
2026-01-10 16:33:39 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/sentence_bert_config.json HTTP/1.1" 307 0
2026-01-10 16:33:39 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/sentence_bert_config.json HTTP/1.1" 200 0
2026-01-10 16:33:39 | DEBUG    | filelock | acquire:331 | Attempting to acquire lock 5065197328 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/ea85692bff64b0d1917833c31ddbca8ab10f5455.lock
2026-01-10 16:33:39 | DEBUG    | filelock | acquire:334 | Lock 5065197328 acquired on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/ea85692bff64b0d1917833c31ddbca8ab10f5455.lock
2026-01-10 16:33:39 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/sentence_bert_config.json HTTP/1.1" 200 52
2026-01-10 16:33:39 | DEBUG    | filelock | release:364 | Attempting to release lock 5065197328 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/ea85692bff64b0d1917833c31ddbca8ab10f5455.lock
2026-01-10 16:33:39 | DEBUG    | filelock | release:367 | Lock 5065197328 released on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/ea85692bff64b0d1917833c31ddbca8ab10f5455.lock
2026-01-10 16:33:40 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/adapter_config.json HTTP/1.1" 404 0
2026-01-10 16:33:40 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/config.json HTTP/1.1" 307 0
2026-01-10 16:33:40 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/config.json HTTP/1.1" 200 0
2026-01-10 16:33:40 | DEBUG    | filelock | acquire:331 | Attempting to acquire lock 5065196944 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/cff4a41431238dfa64d43a8266eddc90fd0f2ded.lock
2026-01-10 16:33:40 | DEBUG    | filelock | acquire:334 | Lock 5065196944 acquired on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/cff4a41431238dfa64d43a8266eddc90fd0f2ded.lock
2026-01-10 16:33:40 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/config.json HTTP/1.1" 200 719
2026-01-10 16:33:40 | DEBUG    | filelock | release:364 | Attempting to release lock 5065196944 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/cff4a41431238dfa64d43a8266eddc90fd0f2ded.lock
2026-01-10 16:33:40 | DEBUG    | filelock | release:367 | Lock 5065196944 released on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/cff4a41431238dfa64d43a8266eddc90fd0f2ded.lock
2026-01-10 16:33:41 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/model.safetensors HTTP/1.1" 302 0
2026-01-10 16:33:41 | DEBUG    | filelock | acquire:331 | Attempting to acquire lock 5073829232 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/efa751a822b7eb0a7db5d0167b6e38ffd6ad1978e71de205d7c0efedcc18bf2a.lock
2026-01-10 16:33:41 | DEBUG    | filelock | acquire:334 | Lock 5073829232 acquired on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/efa751a822b7eb0a7db5d0167b6e38ffd6ad1978e71de205d7c0efedcc18bf2a.lock
2026-01-10 16:33:42 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/models/avsolatorio/GIST-small-Embedding-v0/xet-read-token/75e62fd210b9fde790430e0b2f040b0b00a021b1 HTTP/1.1" 200 365
2026-01-10 16:33:49 | DEBUG    | filelock | release:364 | Attempting to release lock 5073829232 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/efa751a822b7eb0a7db5d0167b6e38ffd6ad1978e71de205d7c0efedcc18bf2a.lock
2026-01-10 16:33:49 | DEBUG    | filelock | release:367 | Lock 5073829232 released on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/efa751a822b7eb0a7db5d0167b6e38ffd6ad1978e71de205d7c0efedcc18bf2a.lock
2026-01-10 16:33:49 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/tokenizer_config.json HTTP/1.1" 307 0
2026-01-10 16:33:49 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/tokenizer_config.json HTTP/1.1" 200 0
2026-01-10 16:33:49 | DEBUG    | filelock | acquire:331 | Attempting to acquire lock 5071538944 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/75305659f7795d4549f0e23688b52fa20a32f925.lock
2026-01-10 16:33:49 | DEBUG    | filelock | acquire:334 | Lock 5071538944 acquired on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/75305659f7795d4549f0e23688b52fa20a32f925.lock
2026-01-10 16:33:50 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/tokenizer_config.json HTTP/1.1" 200 None
2026-01-10 16:33:50 | DEBUG    | filelock | release:364 | Attempting to release lock 5071538944 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/75305659f7795d4549f0e23688b52fa20a32f925.lock
2026-01-10 16:33:50 | DEBUG    | filelock | release:367 | Lock 5071538944 released on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/75305659f7795d4549f0e23688b52fa20a32f925.lock
2026-01-10 16:33:50 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/models/avsolatorio/GIST-small-Embedding-v0/tree/main/additional_chat_templates?recursive=False&expand=False HTTP/1.1" 404 64
2026-01-10 16:33:50 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/models/avsolatorio/GIST-small-Embedding-v0/tree/main?recursive=True&expand=False HTTP/1.1" 200 2759
2026-01-10 16:33:50 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/vocab.txt HTTP/1.1" 307 0
2026-01-10 16:33:50 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/vocab.txt HTTP/1.1" 200 0
2026-01-10 16:33:50 | DEBUG    | filelock | acquire:331 | Attempting to acquire lock 5073759184 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/fb140275c155a9c7c5a3b3e0e77a9e839594a938.lock
2026-01-10 16:33:50 | DEBUG    | filelock | acquire:334 | Lock 5073759184 acquired on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/fb140275c155a9c7c5a3b3e0e77a9e839594a938.lock
2026-01-10 16:33:50 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/vocab.txt HTTP/1.1" 200 None
2026-01-10 16:33:51 | DEBUG    | filelock | release:364 | Attempting to release lock 5073759184 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/fb140275c155a9c7c5a3b3e0e77a9e839594a938.lock
2026-01-10 16:33:51 | DEBUG    | filelock | release:367 | Lock 5073759184 released on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/fb140275c155a9c7c5a3b3e0e77a9e839594a938.lock
2026-01-10 16:33:51 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/tokenizer.json HTTP/1.1" 307 0
2026-01-10 16:33:51 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/tokenizer.json HTTP/1.1" 200 0
2026-01-10 16:33:51 | DEBUG    | filelock | acquire:331 | Attempting to acquire lock 5071512704 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/688882a79f44442ddc1f60d70334a7ff5df0fb47.lock
2026-01-10 16:33:51 | DEBUG    | filelock | acquire:334 | Lock 5071512704 acquired on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/688882a79f44442ddc1f60d70334a7ff5df0fb47.lock
2026-01-10 16:33:51 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/tokenizer.json HTTP/1.1" 200 None
2026-01-10 16:33:51 | DEBUG    | filelock | release:364 | Attempting to release lock 5071512704 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/688882a79f44442ddc1f60d70334a7ff5df0fb47.lock
2026-01-10 16:33:51 | DEBUG    | filelock | release:367 | Lock 5071512704 released on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/688882a79f44442ddc1f60d70334a7ff5df0fb47.lock
2026-01-10 16:33:51 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/added_tokens.json HTTP/1.1" 404 0
2026-01-10 16:33:52 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/special_tokens_map.json HTTP/1.1" 307 0
2026-01-10 16:33:52 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/special_tokens_map.json HTTP/1.1" 200 0
2026-01-10 16:33:52 | DEBUG    | filelock | acquire:331 | Attempting to acquire lock 5071512704 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/9bbecc17cabbcbd3112c14d6982b51403b264bfa.lock
2026-01-10 16:33:52 | DEBUG    | filelock | acquire:334 | Lock 5071512704 acquired on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/9bbecc17cabbcbd3112c14d6982b51403b264bfa.lock
2026-01-10 16:33:52 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/special_tokens_map.json HTTP/1.1" 200 695
2026-01-10 16:33:52 | DEBUG    | filelock | release:364 | Attempting to release lock 5071512704 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/9bbecc17cabbcbd3112c14d6982b51403b264bfa.lock
2026-01-10 16:33:52 | DEBUG    | filelock | release:367 | Lock 5071512704 released on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/9bbecc17cabbcbd3112c14d6982b51403b264bfa.lock
2026-01-10 16:33:52 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2026-01-10 16:33:52 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/1_Pooling/config.json HTTP/1.1" 307 0
2026-01-10 16:33:52 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/1_Pooling%2Fconfig.json HTTP/1.1" 200 0
2026-01-10 16:33:52 | DEBUG    | filelock | acquire:331 | Attempting to acquire lock 5071370240 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/1da070f0993788c8851a652170ff013aa54dd519.lock
2026-01-10 16:33:52 | DEBUG    | filelock | acquire:334 | Lock 5071370240 acquired on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/1da070f0993788c8851a652170ff013aa54dd519.lock
2026-01-10 16:33:52 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/1_Pooling%2Fconfig.json HTTP/1.1" 200 190
2026-01-10 16:33:52 | DEBUG    | filelock | release:364 | Attempting to release lock 5071370240 on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/1da070f0993788c8851a652170ff013aa54dd519.lock
2026-01-10 16:33:52 | DEBUG    | filelock | release:367 | Lock 5071370240 released on /Users/ramlanjekar/.cache/huggingface/hub/.locks/models--avsolatorio--GIST-small-Embedding-v0/1da070f0993788c8851a652170ff013aa54dd519.lock
2026-01-10 16:33:53 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/models/avsolatorio/GIST-small-Embedding-v0 HTTP/1.1" 200 146259
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='localhost' port=6333 local_address=None timeout=5.0 socket_options=None
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12e6c5b20>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'GET']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'GET']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'GET']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'transfer-encoding', b'chunked'), (b'content-encoding', b'zstd'), (b'content-type', b'application/json'), (b'vary', b'accept-encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers'), (b'date', b'Sat, 10 Jan 2026 11:04:08 GMT')])
2026-01-10 16:34:09 | INFO     | httpx | _send_single_request:1025 | HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'GET']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | close.started
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | close.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='localhost' port=6333 local_address=None timeout=5.0 socket_options=None
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12e6cb650>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'GET']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'GET']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'GET']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'transfer-encoding', b'chunked'), (b'content-encoding', b'zstd'), (b'vary', b'accept-encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers'), (b'content-type', b'application/json'), (b'date', b'Sat, 10 Jan 2026 11:04:08 GMT')])
2026-01-10 16:34:09 | INFO     | httpx | _send_single_request:1025 | HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'GET']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | close.started
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | close.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='localhost' port=6333 local_address=None timeout=5.0 socket_options=None
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12e96fb90>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'DELETE']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'DELETE']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'DELETE']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'transfer-encoding', b'chunked'), (b'content-type', b'application/json'), (b'vary', b'accept-encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers'), (b'content-encoding', b'zstd'), (b'date', b'Sat, 10 Jan 2026 11:04:08 GMT')])
2026-01-10 16:34:09 | INFO     | httpx | _send_single_request:1025 | HTTP Request: DELETE http://localhost:6333/collections/in%20search%20of%20the%20castaways_collection "HTTP/1.1 200 OK"
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'DELETE']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | close.started
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | close.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='localhost' port=6333 local_address=None timeout=5.0 socket_options=None
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12e976ae0>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'PUT']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'PUT']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'PUT']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'transfer-encoding', b'chunked'), (b'content-type', b'application/json'), (b'content-encoding', b'zstd'), (b'vary', b'accept-encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers'), (b'date', b'Sat, 10 Jan 2026 11:04:08 GMT')])
2026-01-10 16:34:09 | INFO     | httpx | _send_single_request:1025 | HTTP Request: PUT http://localhost:6333/collections/in%20search%20of%20the%20castaways_collection "HTTP/1.1 200 OK"
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'PUT']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | close.started
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | close.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='localhost' port=6333 local_address=None timeout=5.0 socket_options=None
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12e96f800>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'PUT']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'PUT']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'PUT']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'transfer-encoding', b'chunked'), (b'content-type', b'application/json'), (b'vary', b'accept-encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers'), (b'content-encoding', b'zstd'), (b'date', b'Sat, 10 Jan 2026 11:04:09 GMT')])
2026-01-10 16:34:09 | INFO     | httpx | _send_single_request:1025 | HTTP Request: PUT http://localhost:6333/collections/in%20search%20of%20the%20castaways_collection/points?wait=true "HTTP/1.1 200 OK"
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'PUT']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | close.started
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | close.complete
2026-01-10 16:34:09 | INFO     | __main__ | run_pipeline_for_row:137 | Processing: Thalcave from In Search of the Castaways
2026-01-10 16:34:09 | INFO     | __main__ | run_pipeline_for_row:156 | Running pipeline
2026-01-10 16:34:09 | INFO     | extraction_agent.main | extract:42 | Starting extraction agent
2026-01-10 16:34:09 | INFO     | extraction_agent.main | extract:43 | Book: In Search of the Castaways, Character: Thalcave
2026-01-10 16:34:09 | DEBUG    | extraction_agent.main | extract:56 | Extraction prompt: You are an extractor agent.
Generate 5 queries to retrieve evidence about the character.

Book: In Search of the Castaways
Character: Thalcave
Backstory: Thalcave’s people faded as colonists advanced; his father, last of the tribal guides, knew the pampas geography and animal ways, while his mother died giving birth. Boyhood was spent roaming the plains with his father, learning to track, tame horses and steer by the stars.

Return only a JSON list of strings, each string being a query.
Example: ["query 1", "query 2", "query 3"]

2026-01-10 16:34:09 | INFO     | extraction_agent.main | extract:59 | Generating queries via LLM
2026-01-10 16:34:09 | DEBUG    | openai._base_client | _build_request:482 | Request options: {'method': 'post', 'url': '/chat/completions', 'headers': {'X-Stainless-Raw-Response': 'true'}, 'files': None, 'idempotency_key': 'stainless-python-retry-673266c5-b903-4ba9-9d56-9d086ac12cc0', 'json_data': {'messages': [{'content': 'You are an extractor agent.\nGenerate 5 queries to retrieve evidence about the character.\n\nBook: In Search of the Castaways\nCharacter: Thalcave\nBackstory: Thalcave’s people faded as colonists advanced; his father, last of the tribal guides, knew the pampas geography and animal ways, while his mother died giving birth. Boyhood was spent roaming the plains with his father, learning to track, tame horses and steer by the stars.\n\nReturn only a JSON list of strings, each string being a query.\nExample: ["query 1", "query 2", "query 3"]\n', 'role': 'user'}], 'model': 'mistralai/devstral-2512:free', 'stream': False}}
2026-01-10 16:34:09 | DEBUG    | openai._base_client | request:978 | Sending HTTP Request: POST https://openrouter.ai/api/v1/chat/completions
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='openrouter.ai' port=443 local_address=None timeout=None socket_options=None
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12f27eba0>
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | start_tls.started ssl_context=<ssl.SSLContext object at 0x12ee36c50> server_hostname='openrouter.ai' timeout=None
2026-01-10 16:34:09 | DEBUG    | httpcore.connection | trace:47 | start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12f248620>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'POST']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'POST']>
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:34:09 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'POST']>
2026-01-10 16:34:10 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sat, 10 Jan 2026 11:04:10 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'Access-Control-Allow-Origin', b'*'), (b'Vary', b'Accept-Encoding'), (b'Permissions-Policy', b'payment=(self "https://checkout.stripe.com" "https://connect-js.stripe.com" "https://js.stripe.com" "https://*.js.stripe.com" "https://hooks.stripe.com")'), (b'Referrer-Policy', b'no-referrer, strict-origin-when-cross-origin'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9bbbb126593dd7e5-DEL')])
2026-01-10 16:34:10 | INFO     | httpx | _send_single_request:1025 | HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-10 16:34:10 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'POST']>
2026-01-10 16:34:13 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:34:13 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:34:13 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:34:13 | DEBUG    | openai._base_client | request:1016 | HTTP Response: POST https://openrouter.ai/api/v1/chat/completions "200 OK" Headers({'date': 'Sat, 10 Jan 2026 11:04:10 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'access-control-allow-origin': '*', 'vary': 'Accept-Encoding', 'permissions-policy': 'payment=(self "https://checkout.stripe.com" "https://connect-js.stripe.com" "https://js.stripe.com" "https://*.js.stripe.com" "https://hooks.stripe.com")', 'referrer-policy': 'no-referrer, strict-origin-when-cross-origin', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '9bbbb126593dd7e5-DEL'})
2026-01-10 16:34:13 | DEBUG    | openai._base_client | request:1024 | request_id: None
2026-01-10 16:34:13 | DEBUG    | extraction_agent.main | extract:63 | LLM response: ```json
[
  "What is Thalcave's role in 'In Search of the Castaways' and how does his backstory influence his actions?",
  "How does Thalcave's knowledge of the pampas geography and animal ways contribute to the plot of the story?",
  "What are the key events in Thalcave's life that shape his character, particularly his upbringing with his father?",
  "How does Thalcave's heritage and the decline of his people affect his interactions with other characters in the book?",
  "What skills does Thalcave possess, such as tracking and taming horses, and how do these skills aid the protagonists in their journey?"
]
```
2026-01-10 16:34:13 | INFO     | extraction_agent.main | extract:82 | Generated 5 queries
2026-01-10 16:34:13 | INFO     | extraction_agent.main | extract:92 | Getting evidence for query: What is Thalcave's role in 'In Search of the Castaways' and how does his backstory influence his actions?
2026-01-10 16:34:13 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='localhost' port=6333 local_address=None timeout=5.0 socket_options=None
2026-01-10 16:34:13 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x12f2b83b0>
2026-01-10 16:34:13 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'GET']>
2026-01-10 16:34:13 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:34:13 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'GET']>
2026-01-10 16:34:13 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:34:13 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'GET']>
2026-01-10 16:34:13 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'transfer-encoding', b'chunked'), (b'content-type', b'application/json'), (b'vary', b'accept-encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers'), (b'content-encoding', b'zstd'), (b'date', b'Sat, 10 Jan 2026 11:04:13 GMT')])
2026-01-10 16:34:13 | INFO     | httpx | _send_single_request:1025 | HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2026-01-10 16:34:13 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'GET']>
2026-01-10 16:34:13 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:34:13 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:34:13 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:34:13 | DEBUG    | httpcore.connection | trace:47 | close.started
2026-01-10 16:34:13 | DEBUG    | httpcore.connection | trace:47 | close.complete
2026-01-10 16:34:13 | INFO     | sentence_transformers.SentenceTransformer | __init__:227 | Load pretrained SentenceTransformer: avsolatorio/GIST-small-Embedding-v0
2026-01-10 16:34:14 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/modules.json HTTP/1.1" 307 0
2026-01-10 16:34:14 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/modules.json HTTP/1.1" 200 0
2026-01-10 16:34:14 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/config_sentence_transformers.json HTTP/1.1" 307 0
2026-01-10 16:34:14 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/config_sentence_transformers.json HTTP/1.1" 200 0
2026-01-10 16:34:14 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/config_sentence_transformers.json HTTP/1.1" 307 0
2026-01-10 16:34:14 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/config_sentence_transformers.json HTTP/1.1" 200 0
2026-01-10 16:34:15 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/README.md HTTP/1.1" 307 0
2026-01-10 16:34:15 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/README.md HTTP/1.1" 200 0
2026-01-10 16:34:15 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/modules.json HTTP/1.1" 307 0
2026-01-10 16:34:15 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/modules.json HTTP/1.1" 200 0
2026-01-10 16:34:15 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/sentence_bert_config.json HTTP/1.1" 307 0
2026-01-10 16:34:15 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/sentence_bert_config.json HTTP/1.1" 200 0
2026-01-10 16:34:15 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/adapter_config.json HTTP/1.1" 404 0
2026-01-10 16:34:16 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/config.json HTTP/1.1" 307 0
2026-01-10 16:34:16 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/config.json HTTP/1.1" 200 0
2026-01-10 16:34:16 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/tokenizer_config.json HTTP/1.1" 307 0
2026-01-10 16:34:16 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/tokenizer_config.json HTTP/1.1" 200 0
2026-01-10 16:34:16 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/models/avsolatorio/GIST-small-Embedding-v0/tree/main/additional_chat_templates?recursive=False&expand=False HTTP/1.1" 404 64
2026-01-10 16:34:17 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/models/avsolatorio/GIST-small-Embedding-v0/tree/main?recursive=True&expand=False HTTP/1.1" 200 2759
2026-01-10 16:34:17 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/1_Pooling/config.json HTTP/1.1" 307 0
2026-01-10 16:34:17 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/1_Pooling%2Fconfig.json HTTP/1.1" 200 0
2026-01-10 16:34:17 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/models/avsolatorio/GIST-small-Embedding-v0 HTTP/1.1" 200 146259
2026-01-10 16:34:18 | ERROR    | __main__ | main:225 | Error processing row 1: 'list' object has no attribute 'astype'
Traceback (most recent call last):
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/main.py", line 218, in main
    final_state = run_pipeline_for_row(row_data)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/main.py", line 159, in run_pipeline_for_row
    final_state = app.invoke(initial_state)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/.venv/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3068, in invoke
    for chunk in self.stream(
                 ^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/.venv/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2643, in stream
    for _ in runner.tick(
             ^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/.venv/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 167, in tick
    run_with_retry(
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/.venv/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 42, in run_with_retry
    return task.proc.invoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/.venv/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 656, in invoke
    input = context.run(step.invoke, input, config, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/.venv/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 400, in invoke
    ret = self.func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/extraction_agent/main.py", line 93, in extract
    evidence_dict = get_evidence(query, state["book_name"])
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/extraction_agent/main.py", line 29, in get_evidence
    fake_evidences = retrieve_topk(book_name, query, k=5)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/Graphrag/pathway/retriever.py", line 66, in retrieve_topk
    q_emb = embedder.__wrapped__([query])[0].astype(float).tolist()
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'astype'
During task with name 'extract' and id 'c6a7ca7c-dae7-3e43-294a-537c28114e72'
2026-01-10 16:34:18 | DEBUG    | asyncio | __init__:64 | Using selector: KqueueSelector
2026-01-10 16:34:18 | INFO     | pathway_engine.engine.dataflow | None:5322 | Preparing Pathway computation
2026-01-10 16:34:18 | DEBUG    | pathway_engine.engine.telemetry | None:399 | Telemetry disabled
2026-01-10 16:34:18 | INFO     | pathway_engine.connectors.monitoring | None:43 | FilesystemReader-0: 0 entries (1 minibatch(es)) have been sent to the engine
2026-01-10 16:34:18 | INFO     | pathway_engine.connectors.monitoring | None:43 | FilesystemReader-0: 61676 entries (2 minibatch(es)) have been sent to the engine
2026-01-10 16:34:18 | WARNING  | pathway_engine.connectors.monitoring | None:82 | FilesystemReader-0: Closing the data source
2026-01-10 16:34:18 | INFO     | sentence_transformers.SentenceTransformer | __init__:227 | Load pretrained SentenceTransformer: avsolatorio/GIST-small-Embedding-v0
2026-01-10 16:34:18 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/modules.json HTTP/1.1" 307 0
2026-01-10 16:34:18 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/modules.json HTTP/1.1" 200 0
2026-01-10 16:34:19 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/config_sentence_transformers.json HTTP/1.1" 307 0
2026-01-10 16:34:19 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/config_sentence_transformers.json HTTP/1.1" 200 0
2026-01-10 16:34:19 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/config_sentence_transformers.json HTTP/1.1" 307 0
2026-01-10 16:34:19 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/config_sentence_transformers.json HTTP/1.1" 200 0
2026-01-10 16:34:19 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/README.md HTTP/1.1" 307 0
2026-01-10 16:34:19 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/README.md HTTP/1.1" 200 0
2026-01-10 16:34:20 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/modules.json HTTP/1.1" 307 0
2026-01-10 16:34:20 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/modules.json HTTP/1.1" 200 0
2026-01-10 16:34:20 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/sentence_bert_config.json HTTP/1.1" 307 0
2026-01-10 16:34:20 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/sentence_bert_config.json HTTP/1.1" 200 0
2026-01-10 16:34:20 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/adapter_config.json HTTP/1.1" 404 0
2026-01-10 16:34:20 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/config.json HTTP/1.1" 307 0
2026-01-10 16:34:20 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/config.json HTTP/1.1" 200 0
2026-01-10 16:34:21 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/tokenizer_config.json HTTP/1.1" 307 0
2026-01-10 16:34:21 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/tokenizer_config.json HTTP/1.1" 200 0
2026-01-10 16:34:21 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/models/avsolatorio/GIST-small-Embedding-v0/tree/main/additional_chat_templates?recursive=False&expand=False HTTP/1.1" 404 64
2026-01-10 16:34:21 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/models/avsolatorio/GIST-small-Embedding-v0/tree/main?recursive=True&expand=False HTTP/1.1" 200 2759
2026-01-10 16:34:22 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /avsolatorio/GIST-small-Embedding-v0/resolve/main/1_Pooling/config.json HTTP/1.1" 307 0
2026-01-10 16:34:22 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "HEAD /api/resolve-cache/models/avsolatorio/GIST-small-Embedding-v0/75e62fd210b9fde790430e0b2f040b0b00a021b1/1_Pooling%2Fconfig.json HTTP/1.1" 200 0
2026-01-10 16:34:22 | DEBUG    | urllib3.connectionpool | _make_request:544 | https://huggingface.co:443 "GET /api/models/avsolatorio/GIST-small-Embedding-v0 HTTP/1.1" 200 146259
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='localhost' port=6333 local_address=None timeout=5.0 socket_options=None
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x132e9cb60>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'GET']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'GET']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'GET']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'transfer-encoding', b'chunked'), (b'content-type', b'application/json'), (b'content-encoding', b'zstd'), (b'vary', b'accept-encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers'), (b'date', b'Sat, 10 Jan 2026 11:05:16 GMT')])
2026-01-10 16:35:16 | INFO     | httpx | _send_single_request:1025 | HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'GET']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | close.started
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | close.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='localhost' port=6333 local_address=None timeout=5.0 socket_options=None
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x132e9ccb0>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'GET']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'GET']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'GET']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'transfer-encoding', b'chunked'), (b'content-encoding', b'zstd'), (b'vary', b'accept-encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers'), (b'content-type', b'application/json'), (b'date', b'Sat, 10 Jan 2026 11:05:16 GMT')])
2026-01-10 16:35:16 | INFO     | httpx | _send_single_request:1025 | HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'GET']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | close.started
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | close.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='localhost' port=6333 local_address=None timeout=5.0 socket_options=None
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x132e9c890>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'DELETE']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'DELETE']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'DELETE']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'transfer-encoding', b'chunked'), (b'content-type', b'application/json'), (b'vary', b'accept-encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers'), (b'content-encoding', b'zstd'), (b'date', b'Sat, 10 Jan 2026 11:05:16 GMT')])
2026-01-10 16:35:16 | INFO     | httpx | _send_single_request:1025 | HTTP Request: DELETE http://localhost:6333/collections/the%20count%20of%20monte%20cristo_collection "HTTP/1.1 200 OK"
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'DELETE']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | close.started
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | close.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='localhost' port=6333 local_address=None timeout=5.0 socket_options=None
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x132e7b3e0>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'PUT']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'PUT']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'PUT']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'transfer-encoding', b'chunked'), (b'content-encoding', b'zstd'), (b'content-type', b'application/json'), (b'vary', b'accept-encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers'), (b'date', b'Sat, 10 Jan 2026 11:05:16 GMT')])
2026-01-10 16:35:16 | INFO     | httpx | _send_single_request:1025 | HTTP Request: PUT http://localhost:6333/collections/the%20count%20of%20monte%20cristo_collection "HTTP/1.1 200 OK"
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'PUT']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | close.started
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | close.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='localhost' port=6333 local_address=None timeout=5.0 socket_options=None
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x132e9cbc0>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'PUT']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'PUT']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'PUT']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'transfer-encoding', b'chunked'), (b'content-encoding', b'zstd'), (b'vary', b'accept-encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers'), (b'content-type', b'application/json'), (b'date', b'Sat, 10 Jan 2026 11:05:16 GMT')])
2026-01-10 16:35:16 | INFO     | httpx | _send_single_request:1025 | HTTP Request: PUT http://localhost:6333/collections/the%20count%20of%20monte%20cristo_collection/points?wait=true "HTTP/1.1 200 OK"
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'PUT']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | close.started
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | close.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='localhost' port=6333 local_address=None timeout=5.0 socket_options=None
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x132e9e4e0>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'PUT']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'PUT']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'PUT']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'transfer-encoding', b'chunked'), (b'content-type', b'application/json'), (b'vary', b'accept-encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers'), (b'content-encoding', b'zstd'), (b'date', b'Sat, 10 Jan 2026 11:05:16 GMT')])
2026-01-10 16:35:16 | INFO     | httpx | _send_single_request:1025 | HTTP Request: PUT http://localhost:6333/collections/the%20count%20of%20monte%20cristo_collection/points?wait=true "HTTP/1.1 200 OK"
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'PUT']>
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:35:16 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | close.started
2026-01-10 16:35:16 | DEBUG    | httpcore.connection | trace:47 | close.complete
2026-01-10 16:35:17 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='localhost' port=6333 local_address=None timeout=5.0 socket_options=None
2026-01-10 16:35:17 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x132e9e1b0>
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'PUT']>
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'PUT']>
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'PUT']>
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'transfer-encoding', b'chunked'), (b'content-type', b'application/json'), (b'content-encoding', b'zstd'), (b'vary', b'accept-encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers'), (b'date', b'Sat, 10 Jan 2026 11:05:16 GMT')])
2026-01-10 16:35:17 | INFO     | httpx | _send_single_request:1025 | HTTP Request: PUT http://localhost:6333/collections/the%20count%20of%20monte%20cristo_collection/points?wait=true "HTTP/1.1 200 OK"
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'PUT']>
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:35:17 | DEBUG    | httpcore.connection | trace:47 | close.started
2026-01-10 16:35:17 | DEBUG    | httpcore.connection | trace:47 | close.complete
2026-01-10 16:35:17 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='localhost' port=6333 local_address=None timeout=5.0 socket_options=None
2026-01-10 16:35:17 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x132e9dfd0>
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'PUT']>
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'PUT']>
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'PUT']>
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'transfer-encoding', b'chunked'), (b'content-type', b'application/json'), (b'vary', b'accept-encoding, Origin, Access-Control-Request-Method, Access-Control-Request-Headers'), (b'content-encoding', b'zstd'), (b'date', b'Sat, 10 Jan 2026 11:05:16 GMT')])
2026-01-10 16:35:17 | INFO     | httpx | _send_single_request:1025 | HTTP Request: PUT http://localhost:6333/collections/the%20count%20of%20monte%20cristo_collection/points?wait=true "HTTP/1.1 200 OK"
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'PUT']>
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:35:17 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:35:17 | DEBUG    | httpcore.connection | trace:47 | close.started
2026-01-10 16:35:17 | DEBUG    | httpcore.connection | trace:47 | close.complete
2026-01-10 16:35:17 | INFO     | __main__ | run_pipeline_for_row:137 | Processing: Faria from The Count of Monte Cristo
2026-01-10 16:35:17 | INFO     | __main__ | run_pipeline_for_row:156 | Running pipeline
2026-01-10 16:35:17 | INFO     | extraction_agent.main | extract:42 | Starting extraction agent
2026-01-10 16:35:17 | INFO     | extraction_agent.main | extract:43 | Book: The Count of Monte Cristo, Character: Faria
2026-01-10 16:35:17 | DEBUG    | extraction_agent.main | extract:56 | Extraction prompt: You are an extractor agent.
Generate 5 queries to retrieve evidence about the character.

Book: The Count of Monte Cristo
Character: Faria
Backstory: Suspected again in 1815, he was re-arrested and shipped to the Château d’If, this time for life.

Return only a JSON list of strings, each string being a query.
Example: ["query 1", "query 2", "query 3"]

2026-01-10 16:35:17 | INFO     | extraction_agent.main | extract:59 | Generating queries via LLM
2026-01-10 16:35:17 | DEBUG    | openai._base_client | _build_request:482 | Request options: {'method': 'post', 'url': '/chat/completions', 'headers': {'X-Stainless-Raw-Response': 'true'}, 'files': None, 'idempotency_key': 'stainless-python-retry-df80cb57-12d0-42bd-837b-6eb97c508b42', 'json_data': {'messages': [{'content': 'You are an extractor agent.\nGenerate 5 queries to retrieve evidence about the character.\n\nBook: The Count of Monte Cristo\nCharacter: Faria\nBackstory: Suspected again in 1815, he was re-arrested and shipped to the Château d’If, this time for life.\n\nReturn only a JSON list of strings, each string being a query.\nExample: ["query 1", "query 2", "query 3"]\n', 'role': 'user'}], 'model': 'mistralai/devstral-2512:free', 'stream': False}}
2026-01-10 16:35:17 | DEBUG    | openai._base_client | request:978 | Sending HTTP Request: POST https://openrouter.ai/api/v1/chat/completions
2026-01-10 16:35:17 | DEBUG    | httpcore.connection | trace:47 | close.started
2026-01-10 16:35:17 | DEBUG    | httpcore.connection | trace:47 | close.complete
2026-01-10 16:35:17 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.started host='openrouter.ai' port=443 local_address=None timeout=None socket_options=None
2026-01-10 16:35:18 | DEBUG    | httpcore.connection | trace:47 | connect_tcp.complete return_value=<httpcore._backends.sync.SyncStream object at 0x132e9eba0>
2026-01-10 16:35:18 | DEBUG    | httpcore.connection | trace:47 | start_tls.started ssl_context=<ssl.SSLContext object at 0x12ee36c50> server_hostname='openrouter.ai' timeout=None
2026-01-10 16:35:18 | DEBUG    | httpcore.connection | trace:47 | start_tls.complete return_value=<httpcore._backends.sync.SyncStream object at 0x132e9df70>
2026-01-10 16:35:18 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.started request=<Request [b'POST']>
2026-01-10 16:35:18 | DEBUG    | httpcore.http11 | trace:47 | send_request_headers.complete
2026-01-10 16:35:18 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.started request=<Request [b'POST']>
2026-01-10 16:35:18 | DEBUG    | httpcore.http11 | trace:47 | send_request_body.complete
2026-01-10 16:35:18 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.started request=<Request [b'POST']>
2026-01-10 16:35:18 | DEBUG    | httpcore.http11 | trace:47 | receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'Date', b'Sat, 10 Jan 2026 11:05:18 GMT'), (b'Content-Type', b'application/json'), (b'Transfer-Encoding', b'chunked'), (b'Connection', b'keep-alive'), (b'Content-Encoding', b'gzip'), (b'Access-Control-Allow-Origin', b'*'), (b'Vary', b'Accept-Encoding'), (b'Permissions-Policy', b'payment=(self "https://checkout.stripe.com" "https://connect-js.stripe.com" "https://js.stripe.com" "https://*.js.stripe.com" "https://hooks.stripe.com")'), (b'Referrer-Policy', b'no-referrer, strict-origin-when-cross-origin'), (b'X-Content-Type-Options', b'nosniff'), (b'Server', b'cloudflare'), (b'CF-RAY', b'9bbbb2d16f6598f2-DEL')])
2026-01-10 16:35:18 | INFO     | httpx | _send_single_request:1025 | HTTP Request: POST https://openrouter.ai/api/v1/chat/completions "HTTP/1.1 200 OK"
2026-01-10 16:35:18 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.started request=<Request [b'POST']>
2026-01-10 16:35:24 | DEBUG    | httpcore.http11 | trace:47 | receive_response_body.complete
2026-01-10 16:35:24 | DEBUG    | httpcore.http11 | trace:47 | response_closed.started
2026-01-10 16:35:24 | DEBUG    | httpcore.http11 | trace:47 | response_closed.complete
2026-01-10 16:35:24 | DEBUG    | openai._base_client | request:1016 | HTTP Response: POST https://openrouter.ai/api/v1/chat/completions "200 OK" Headers({'date': 'Sat, 10 Jan 2026 11:05:18 GMT', 'content-type': 'application/json', 'transfer-encoding': 'chunked', 'connection': 'keep-alive', 'content-encoding': 'gzip', 'access-control-allow-origin': '*', 'vary': 'Accept-Encoding', 'permissions-policy': 'payment=(self "https://checkout.stripe.com" "https://connect-js.stripe.com" "https://js.stripe.com" "https://*.js.stripe.com" "https://hooks.stripe.com")', 'referrer-policy': 'no-referrer, strict-origin-when-cross-origin', 'x-content-type-options': 'nosniff', 'server': 'cloudflare', 'cf-ray': '9bbbb2d16f6598f2-DEL'})
2026-01-10 16:35:24 | DEBUG    | openai._base_client | request:1024 | request_id: None
2026-01-10 16:35:24 | DEBUG    | extraction_agent.main | extract:63 | LLM response: ```json
[
  "What is the backstory of Abbe Faria in The Count of Monte Cristo?",
  "Why was Abbe Faria imprisoned in the Château d’If?",
  "What role does Abbe Faria play in Edmond Dantès' life?",
  "How does Abbe Faria contribute to Edmond Dantès' escape plan?",
  "What is the significance of Abbe Faria's knowledge and teachings in the novel?"
]
```
2026-01-10 16:35:24 | INFO     | extraction_agent.main | extract:82 | Generated 5 queries
2026-01-10 16:35:24 | INFO     | extraction_agent.main | extract:92 | Getting evidence for query: What is the backstory of Abbe Faria in The Count of Monte Cristo?
2026-01-10 16:35:24 | ERROR    | __main__ | main:225 | Error processing row 2: 'list' object has no attribute 'astype'
Traceback (most recent call last):
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/main.py", line 218, in main
    final_state = run_pipeline_for_row(row_data)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/main.py", line 159, in run_pipeline_for_row
    final_state = app.invoke(initial_state)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/.venv/lib/python3.12/site-packages/langgraph/pregel/main.py", line 3068, in invoke
    for chunk in self.stream(
                 ^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/.venv/lib/python3.12/site-packages/langgraph/pregel/main.py", line 2643, in stream
    for _ in runner.tick(
             ^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/.venv/lib/python3.12/site-packages/langgraph/pregel/_runner.py", line 167, in tick
    run_with_retry(
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/.venv/lib/python3.12/site-packages/langgraph/pregel/_retry.py", line 42, in run_with_retry
    return task.proc.invoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/.venv/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 656, in invoke
    input = context.run(step.invoke, input, config, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/.venv/lib/python3.12/site-packages/langgraph/_internal/_runnable.py", line 400, in invoke
    ret = self.func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/extraction_agent/main.py", line 93, in extract
    evidence_dict = get_evidence(query, state["book_name"])
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/extraction_agent/main.py", line 29, in get_evidence
    fake_evidences = retrieve_topk(book_name, query, k=5)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ramlanjekar/Documents/MyProjects/KDAG/Graphrag/pathway/retriever.py", line 66, in retrieve_topk
    q_emb = embedder.__wrapped__([query])[0].astype(float).tolist()
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'list' object has no attribute 'astype'
During task with name 'extract' and id '4d17ccad-801a-7ae0-184a-34f06fa0638d'
