2026-01-11 19:01:46 | INFO     | root | setup_logging:81 | Logging initialized. Log file: logs/run_20260111_190146.log
2026-01-11 19:01:46 | INFO     | __main__ | main:192 | Starting Evidence-Grounded Backstory Consistency System

How do you want to select rows?
  1. Enter specific row indices (e.g., '0 5 7')
  2. Enter start and end range (e.g., 0 to 10)
Enter choice (1 or 2): Enter start row index (0-indexed): 2026-01-11 19:01:46 | INFO     | __main__ | main:220 | Invalid input, using default: row 0
2026-01-11 19:01:46 | INFO     | __main__ | main:225 | Loaded 1 rows from train.csv: [0]
2026-01-11 19:01:46 | INFO     | __main__ | main:226 | Processing 1 backstories
2026-01-11 19:01:46 | INFO     | __main__ | main:239 | Initialized features_output.csv with 393 columns
2026-01-11 19:01:46 | INFO     | httpx | _send_single_request:1025 | HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2026-01-11 19:01:46 | INFO     | sentence_transformers.SentenceTransformer | __init__:219 | Use pytorch device_name: mps
2026-01-11 19:01:46 | INFO     | sentence_transformers.SentenceTransformer | __init__:227 | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2

================================================================================
[1/1] Processing CSV Row Index: 0
Character: Thalcave
Book: In Search of the Castaways
================================================================================

Target Collection: in search of the castaways_collection
Reading novel: Books/In search of the castaways.txt
Read successful: 826131 characters
Read 826131 characters.
Splitting text with RecursiveCharacterTextSplitter (size=1000, overlap=100)...
Got 1045 chunks.
Computing embeddings with model 'sentence-transformers/all-MiniLM-L6-v2'...
Batches:   0%|          | 0/17 [00:00<?, ?it/s]Batches:   6%|▌         | 1/17 [00:00<00:07,  2.15it/s]Batches:  12%|█▏        | 2/17 [00:00<00:05,  2.58it/s]Batches:  18%|█▊        | 3/17 [00:01<00:05,  2.72it/s]Batches:  24%|██▎       | 4/17 [00:01<00:04,  2.82it/s]Batches:  29%|██▉       | 5/17 [00:01<00:04,  2.88it/s]Batches:  35%|███▌      | 6/17 [00:02<00:03,  2.84it/s]Batches:  41%|████      | 7/17 [00:02<00:03,  2.88it/s]Batches:  47%|████▋     | 8/17 [00:02<00:03,  2.91it/s]Batches:  53%|█████▎    | 9/17 [00:03<00:02,  2.95it/s]Batches:  59%|█████▉    | 10/17 [00:03<00:02,  3.01it/s]Batches:  65%|██████▍   | 11/17 [00:03<00:01,  3.07it/s]Batches:  71%|███████   | 12/17 [00:04<00:01,  3.21it/s]Batches:  76%|███████▋  | 13/17 [00:04<00:01,  3.33it/s]Batches:  82%|████████▏ | 14/17 [00:04<00:00,  3.53it/s]Batches:  88%|████████▊ | 15/17 [00:04<00:00,  3.80it/s]Batches:  94%|█████████▍| 16/17 [00:05<00:00,  4.16it/s]Batches: 100%|██████████| 17/17 [00:05<00:00,  3.36it/s]
2026-01-11 19:01:56 | INFO     | httpx | _send_single_request:1025 | HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2026-01-11 19:01:56 | INFO     | httpx | _send_single_request:1025 | HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2026-01-11 19:01:56 | INFO     | httpx | _send_single_request:1025 | HTTP Request: PUT http://localhost:6333/collections/in%20search%20of%20the%20castaways_collection/points?wait=true "HTTP/1.1 200 OK"
2026-01-11 19:01:56 | INFO     | httpx | _send_single_request:1025 | HTTP Request: PUT http://localhost:6333/collections/in%20search%20of%20the%20castaways_collection/points?wait=true "HTTP/1.1 200 OK"
2026-01-11 19:01:56 | INFO     | httpx | _send_single_request:1025 | HTTP Request: PUT http://localhost:6333/collections/in%20search%20of%20the%20castaways_collection/points?wait=true "HTTP/1.1 200 OK"
2026-01-11 19:01:56 | INFO     | httpx | _send_single_request:1025 | HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2026-01-11 19:01:56 | INFO     | sentence_transformers.SentenceTransformer | __init__:219 | Use pytorch device_name: mps
2026-01-11 19:01:56 | INFO     | sentence_transformers.SentenceTransformer | __init__:227 | Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
Embeddings shape: (1045, 384)
Upserting 1045 vectors into Qdrant collection 'in search of the castaways_collection'...
Indexing done.
Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|██████████| 1/1 [00:00<00:00, 19.21it/s]
2026-01-11 19:02:01 | INFO     | httpx | _send_single_request:1025 | HTTP Request: POST http://localhost:6333/collections/in%20search%20of%20the%20castaways_collection/points/query "HTTP/1.1 200 OK"
